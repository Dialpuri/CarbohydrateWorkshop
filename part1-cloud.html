<!doctype html>
<head>
    <meta charset="utf-8">
    <title>Carbohydrate Workshop</title>
    <meta name="author" content="Jordan Dialpuri and Lucy Schofield">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/markdown.css">
    <link rel="stylesheet" href="css/custom.css">
</head>
<body></body>
<div class="container">

    <div class="header">
        <a class="icon" href="index.html"><img src="icons/home.svg"
                                               alt="House icon indicating a link to the homepage of the site"></a>
        <h1>Carbohydrate Workshop</h1>
    </div>

    <h2 class="title">Part 1 - Modelling Carbohydrates using CCP4 Cloud</h2>

    <details open>
        <summary>Contents</summary>
        <ol>
            <li><a href="#introduction">Introduction</a></li>
            <li><a href="#gettingstarted">Getting Started</a></li>
            <li><a href="#modelbuilding">Model Building</a></li>
        </ol>
    </details>

    <h3 id="introduction">1. Introduction</h3>
    <p><i>Coot</i> is a program for macromolecular model building, model completion and validation<sup>1</sup>.
        We will be using <i>Coot</i> alongside CCP4 Cloud<sup>2</sup> to build and refine a carbohydrate chain on a human
        glutamate carboxypeptidase II protein<sup>3</sup> (PDB Code: <a
                href="https://www.ebi.ac.uk/pdbe/entry/pdb/6fe5/index">6FE5</a>).
        This structure was solved up to 1.52 &angst; resolution with approximately 700 residues.
    </p>
    <p>This page outlines what you should do to generate a glycan with some assumed knowledge. If you aren't sure how
        to proceed for any given step, you can take a look at a hint or the extra instructions in the 'How do I do
        that?' sections.
    </p>

    <h3 id="gettingstarted">2. Getting Started</h3>
    <p>
        To get started, open up CCP4 Cloud in remote mode. This part will be specific to your institution, for the York
        Summer School you should open a terminal with your computer in Linux and run the following commands:
        <p>1) <code>source setup-ccp4.com</code></p>
        <p>2) <code>ccp4cloud-remote</code></p>
    </p>
    <p>
        Once CCP4 Cloud has loaded, go ahead and open the tutorial in the 'Other' folder called 'Modelling Carbohydrates'.
    <details>
        <summary class="indent">I'm not sure where to find the tutorial.</summary>
        <p class="indent">Find the CCP4 Cloud menu bar and click the 'Tutorials' button.</p>
        <p class="indent"><img src="images/cloud/cloud-menu-bar.png" alt="CCP4 Cloud menu bar"/></p>
        <p class="indent">Once the Cloud file browser opens, go ahead and double-click the 'Other' folder.</p>
        <p class="indent"><img src="images/cloud/cloud-tutorial-file-browser.png" alt="CCP4 Cloud file browser"/></p>
        <p class="indent">Then double-click on 'T5_003. Modelling Carbohydrates' to open up the tutorial.</p>
        <p class="indent"><img src="images/cloud/cloud-tutorial-other-menu.png" alt="CCP4 Cloud file browser in the Other folder"/></p>
    </details>
    </p>

    <p>Once you have the tutorial open you should see a project structured like this.</p>
    <p><img src="images/cloud/cloud-project-start.png" alt="CCP4 Cloud project structure"/></p>

    <p>The tutorial data you will be using has been loaded and formed into a structure revision. It contains a model
    and reflection data of the human glutamate carboxypeptidase II protein crystal structure we will be working on.
    <details>
        <summary class="indent">What's a structure revision?</summary>
        <p class="indent">
            A structure revision is the way CCP4 Cloud stores data.
            You can learn more <a href="https://cloud.ccp4.ac.uk/manuals/html-userguide/jscofe_qna.structure_revision.html">here</a>.
        </p>
    </details>
    <details>
        <summary class="indent">How were these files generated?</summary>
        <p class="indent">
            These files were generated by refining the deglycosylated deposited model against the observed reflections
            with 10 cycles of REFMAC5 on CCP4 Cloud. This produces our best map (2mFo-DFc) and our difference map (mFo-DFc).
        </p>
    </details>
    </p>
    <p>
        You can take a look at what data has been loaded by clicking on the first task '(0001) - hop on ccp4 cloud'.
    <details>
        <summary class="indent">What's a hop on?</summary>
        <p class="indent">
            Hop on refers to a template created by CCP4 Cloud for use in continuing structure solution, we are using this
            feature to load our data automatically rather than having to download it from this tutorial website and then upload it
            into CCP4 Cloud. You can learn more <a href="https://cloud.ccp4.ac.uk/manuals/html-taskref/doc.task.Migrate.html">here</a>.
        </p>
    </details>
    </p>

    </p>
    <h3 id="modelbuilding">3. Model Building</h3>
    <p>
        Now that we have our project setup, we can start to interactively build the model of a glycan.
        To do this we need to launch <i>Coot</i> from within CCP4 Cloud.
    </p>
    <details>
        <summary class="indent">Hint</summary>
        <p class="indent">Is there something from the hop on task menu that can help us do this? </p>
    </details>

    <p>Once <i>Coot</i> opens, it should look similar to this with an atomic model, best map (2mFo-DFc) and difference map (mFo-DFc) loaded.</p>
    <details>
        <summary class="indent">What does 2mFo-DFc mean?</summary>
        <p class="indent">
            The 2mFo-DFc map is one of the common maps used in crystallography and is not simply a map calculated from
            observed reflection structure factor amplitudes and calculated phases, the addition of weightings from
            the figure of merit (the uncertainty of a given phase) and &sigma;<sub>a</sub> weighting factor often allows
            for a more interpretable map.
            <ul class="indent">
                <li>Fo - Observed Reflections</li>
                <li>Fc - Calculated Reflections</li>
                <li>m - Figure of Merit</li>
                <li>D - &sigma;<sub>a</sub> weight factor</li>
            </ul>
        </p>
    </details>
    <img src="images/coot/coot-initial-look.png" alt="An image of the initial Coot screen"/>
    <p>Look around the model, is there anything that stands out as odd?</p>
    <details>
        <summary class="indent">What's odd?</summary>
        <p class="indent">There is quite a lot of positive difference density for this model, which indicates we may be
        missing part of the model. We're going to try and fix that.
        </p>
    </details>

    <p>This model contains a missing carbohydrate chain, can you spot where it is?</p>
    <details>
        <summary class="indent">How do I find where it is?</summary>
        <p class="indent">
            You can find out where the missing glycan is by looking around the model for an area for a large positive
            difference density, but this may be time-consuming for a big model!
        </p>
        <p class="indent">
            We can ask <i>Coot</i> to look for us using by navigating to
        </p>
        <p class="indent"><code>Validate > Unmodelled blobs...</code></p>
        <p class="indent"><img src="images/coot/coot-validate-blobs.png"
                               alt="An image of Coot highlighting Unmodelled blobs..."></p>
        <p class="indent">Once we click Unmodelled blobs..., a popup will appear asking us to pick a map and model to with.
            In this case, we want to search for blobs in the difference map which show when we contour that map to 4 r.m.s.d.
            Changing from the default of 1.4 r.m.s.d helps us find stronger blobs. You see what this will look for if you
            contour the difference map to 4 sigma. Now click the <code class="inline-code">Find Blobs</code> button to search.
        </p>
        <p class="indent"><img src="images/coot/coot-validate-blobs-popup.png"
                               alt="An image of Coot highlighting Unmodelled blobs..."></p>
        <p class="indent">
            <i>Coot</i> will then return a list of found blobs, and in our case, there is only one large blob it has found, so we can click on that
            to take us to the area where we have an unmodelled glycan. In a real case, you may not know what should go into a
            big blob of difference density, it could be missing protein, a missing ligand or a missing glycan!
        </p>
        <p class="indent"><img src="images/coot/coot-found-blobs.png"
                               alt="An image of Coot highlighting Unmodelled blobs..."></p>
    </details>
    <p>If we center our view on the blob of green density closest to the protein chain, as shown, we are ready to start
    building a model of the missing carbohydrate chain!</p>
    <img src="images/coot/coot-missing-glycan-density.png" alt="An image of the missing glycan density"/>

    <p><i>Coot</i> has a carbohydrate module we will need to load to be able to do this, navigate to and select
        <code class="inline-code">Calculate > Modules > Carbohydrate</code>, which will add the
        <code class="inline-code">Glyco</code> button in the top bar.
    </p>
    <img src="images/coot/coot-carbohydrate-module.png" alt="An image of Coot's carbohydrate module"/>

    <p>Now we can let the semi-automatic glycan builder in <i>Coot</i> handle the heavy lifting. Center your view
        near to the ASN/476 residue of chain A. Then, navigate to and select
        <code class="inline-code">Glyco > N-link add NAG, NAG, BMA </code>. <i>Coot</i> will then attempt to add the
        first three sugars in an N-glycan chain which are NAG followed with another NAG via a 1,4 linkage, followed by a
        BMA sugar via another 1,4 linkage.
    </p>

    <p><i>Coot</i> should have built three sugars nicely into the best (2mFo-DFc) density map as shown. The terminal
    BMA residue looks to have little density to support it at the moment, however, we must remember that the map was
        calculated in the absence of this carbohydrate chain, so before we make judgements on whether <i>Coot</i> has
    added the carbohydrates correctly, we must re-refine the structure using <i>REFMAC</i>. </p>
    <img src="images/coot/coot-nag-nag-bma-built-norefine.png" alt="An image of Coot's built carbohydrate"/>

    <p>Save the mol back to CCP4 Cloud and exit Coot, now run <i>REFMAC</i> with the new model to refine our structure and calculate a new map</p>
    <details open>
        <summary class="indent">How do I do that?</summary>
        <p class="indent">Navigate to the save button and save the updated coordinates (remember to not change the filename),
        </p>
        <p class="indent">
            <code class="inline-code">File > Save Coordinates > Select Filename > Save</code>
        </p>
        <p class="indent"><img src="images/coot/coot-cloud-save-menu.png"
                               alt="An image of the CCP4i2 popup box for importing merged reflection data"></p>
        <p class="indent">Then navigate to the exit button and click:
            <code class="inline-code">File > Exit</code>.
        </p>
        <p class="indent"><img src="images/coot/coot-cloud-exit-menu.png"
                               alt="An image of the CCP4i2 popup box for importing merged reflection data"></p>
        <p class="indent">Now, select another <i>REFMAC</i> task but we need to change some settings before we can run it.</p>
        <p class="indent">Under restraints, ensure <b>Covalent/metal link identification</b> is set to <b>Yes</b>, and then click <code>Run</code></p>
    </details>

    <p>
        After 10 cycles of link-restrained <i>REFMAC</i> we can reopen our model and map in <i>Coot</i> (navigating back to A/ASN/476)
        to see that the semi-automatic glycan builder has done a good job, but at this point are we finished?
    </p>

    <p><img src="images/coot/coot-nag-nag-bma-refined.png"></p>

    <details open>
        <summary class="indent">Are we finished?</summary>
        Near to the terminal BMA sugar, we see some suspiciously ring shaped positive difference density. Using the
        <code class="inline-code">Glyco</code> module, see if you can come up with what should go there. Remember that
        <i>Coot</i> looks at the center of the view to know where to put new residues, and once they are positioned, we
        should refine using <i>REFMAC</i>. Try your best at modelling more sugars on this carbohydrate chain, we can check
        how well you have done in Part 2 of this workshop!
        <h6><a href="part2.html">Part 2 - Validating Carbohydrates</a></h6>
    </details>

    <hr>
    <h3 id="references">References</h3>
    <ol class="references">
        <li><a class="reference-link" href="https://doi.org/10.1107/S0907444910007493">Emsley, P., Lohkamp, B., Scott,
            W. G. & Cowtan, K. (2010). Features and development of Coot. Acta Cryst. D66, 486-501.</a></li>
        <li><a class="reference-link" href="https://journals.iucr.org/d/issues/2022/09/00/ai5007/index.html">Krissinel, E., Lebedev, A. A., Uski, V., Ballard, C. B., Keegan, R. M., Kovalevskiy, O., Nicholls, R. A., Pannu, N. S., SkubÃ¡k, P., Berrisford, J., Fando, M., Lohkamp, B., Wojdyr, M., Simpkin, A. J., Thomas, J. M. H., Oliver, C., Vonrhein, C., Chojnowski, G., Basle, A., Purkiss, A., Isupov, M. N., McNicholas, S., Lowe, E., Triviao, J., Cowtan, K., Agirre, J., Rigden, D. J., Uson, I., Lamzin, V., Tews, I., Bricogne, G., Leslie, A. G. W. & Brown, D. G. (2022). CCP4 Cloud for structure determination and project management in macromolecular crystallography. Acta Cryst. D78, 1079-1089.</a></li>
        <li><a class="reference-link" href="https://doi.org/10.1016/j.bmc.2018.11.022.">Barinka C, Novakova Z, Hin N, et
            al. Structural and computational basis for potent inhibition of glutamate carboxypeptidase II by
            carbamate-based inhibitors. Bioorg. Med. Chem, Volume 27, Issue 2, 255-264 </a></li>
        <li><a class="reference-link">Murshudov, G. N., Skubak, P., et al. REFMAC5 for the refinement of macromolecular
            crystal structures. Acta Cryst. D67, 355-367.</a></li>

    </ol>
    <hr>
    <p class="acknowledgements">Special thanks to Paul Bond for testing this workshop and for the inspiration. Checkout
    Paul's <i>Coot</i> workshop <a href="https://paulsbond.co.uk/coot-workshop/" target="_blank">here</a> if you want to learn more about <i>Coot</i>.</p>
    <hr>
    <div class="footer">
        <a class="icon" href="mailto:jordan.dialpuri@york.ac.uk"><img src="icons/email.svg"
                                                                      alt="Email icon indicating a link to email an organiser"></a>
        <p>Jordan Dialpuri and Lucy Schofield, University of York</p>
    </div>
</div>
</body>
