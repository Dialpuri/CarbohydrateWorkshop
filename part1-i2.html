<!doctype html>
<head>
    <meta charset="utf-8">
    <title>Carbohydrate Workshop</title>
    <meta name="author" content="Jordan Dialpuri and Lucy Schofield">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="css/normalize.css">
    <link rel="stylesheet" href="css/markdown.css">
    <link rel="stylesheet" href="css/custom.css">
</head>
<body></body>
<div class="container">

    <div class="header">
        <a class="icon" href="index.html"><img src="icons/home.svg"
                                               alt="House icon indicating a link to the homepage of the site"></a>
        <h1>Carbohydrate Workshop</h1>
    </div>

    <h2 class="title">Part 1 - Modelling Carbohydrates using CCP4i2</h2>

    <details open>
        <summary>Contents</summary>
        <ol>
            <li><a href="#introduction">Introduction</a></li>
            <li><a href="#gettingstarted">Getting Started</a></li>
            <li><a href="#modelbuilding">Model Building</a></li>
        </ol>
    </details>

    <h3 id="introduction">1. Introduction</h3>
    <p><i>Coot</i> is a program for macromolecular model building, model completion and validation<sup>1</sup>.
        We will be using <i>Coot</i> alongside CCP4i2<sup>2</sup> to build and refine a carbohydrate chain on a human
        glutamate carboxypeptidase II protein<sup>3</sup> (PDB Code: <a
                href="https://www.ebi.ac.uk/pdbe/entry/pdb/6fe5/index">6FE5</a>).
        This structure was solved up to 1.52 &angst; resolution with approximately 700 residues.
    </p>
    <p>This page outlines what you should do to generate a glycan with some assumed knowledge. If you aren't sure how
        to proceed for any given step, you can take a look at a hint or the extra instructions in the 'How do I do
        that?' sections.
    </p>

    <h3 id="gettingstarted">2. Getting Started</h3>
    <p>
        To get started, download the following files by clicking on them:
    <ul>
        <li>
            <a href="data/carbohydrate-workshop-data.mtz">carbohydrate-workshop-data.mtz</a>
            - reflection data in MTZ format
        </li>
        <li>
            <a href="data/carbohydrate-workshop-data.pdb">carbohydrate-workshop-data.pdb</a>
            - coordinates in PDB format
        </li>
    </ul>

    <details>
        <summary class="indent">How were these files generated?</summary>
        <p class="indent">
            These files were generated by refining the deglycosylated deposited model against the observed reflections
            with 10 cycles of REFMAC5 on CCP4 Cloud.
        </p>
    </details>

    <p>Next, open CCP4i2 and create a new project.
    <details>
        <summary class="indent">How do I do that?</summary>
        <p class="indent">
            To create a new project in CCP4i2, navigate to:
        <p class="indent"><code>File/Projects > New Project</code></p>
        <p class="indent">which should bring up a box as shown, give the project a suitable name and click <code>Create
            project</code></doe></p>
        <p class="indent"><img src="images/new-project-dialogue.png"
                               alt="An image of the CCP4i2 dialogue box for creating a new project"></p>
        </p>
    </details>
    </p>

    <p>Now, import the MTZ file for this workshop into CCP4i2.
    <details>
        <summary class="indent">Hint</summary>
        <p class="indent">The MTZ file contains merged reflections, is there a task that refers to this? </p>
    </details>
    <details>
        <summary class="indent">How do I do that?</summary>
        <p class="indent">
            To import an MTZ file into CCP4i2, :
        <p class="indent"><code>Task menu > Import merged data, AU contents, alignments or coordinates</code></p>
        <p class="indent"><img src="images/import/import-merged-reflection-data-selection.png"
                               alt="An image of the CCP4i2 dialogue box for importing merged reflection data"></p>
        <p class="indent">Clicking on the Import merged reflection data task should bring up the task options</p>
        <p class="indent"><img src="images/import/import-merged-reflection-data-task.png"
                               alt="An image of the CCP4i2 dialogue box for importing merged reflection data"></p>
        <p class="indent">Now the folder icon in the red highlighted area can be selected to bring up a file browser
            where
            you can select the <code class="inline-code">carbohydrate-workshop-data.mtz</code> file. You may be prompted
            to select columns from the MTZ file, you can click <code class="inline-code">Apply</code>. This pop up is
            asking
            what each column that is found in the MTZ file means, in this case, we know that the F
            (Structure Factor Amplitudes) and associated error SIGF are from observed data.
        </p>
        <p class="indent"><img src="images/import/import-merged-reflection-data-popup.png"
                               alt="An image of the CCP4i2 popup box for importing merged reflection data"></p>
        <p class="indent">You can now press the <code class="inline-code">Run</code> button to begin importing the data
        </p>
        </p>
    </details>

    </p>

    <p>We need to generate a best map and difference map for this supplied model to the observed reflections. To do this
        we can run the refinement program <i>REFMAC5</i><sup>4</sup>. In the task labelled 'Refinement
        Refmacat/Refmac5',
        select the reflections and FreeR set that were just imported and import the atomic model downloaded earlier
        (<code class="inline-code">carbohydrate-workshop-data.pdb</code>). Run<i>REFMAC</i>with default settings to generate
        a refined model and recalculated maps.
    <details>
        <summary class="indent">How do I do that?</summary>
        <p class="indent">
            To run<i>REFMAC</i>with our imported reflections and the downloaded atomic model, we can navigate to the REFMAC
            task :
        <p class="indent"><code>Task menu > Refinement Refmacat/Refmac5</code></p>
        <p class="indent"><img src="images/refmac/refmac-task.png"
                               alt="An image of the CCP4i2 dialogue box for REFMAC5"></p>
        <p class="indent">The two red areas tell us we need to select reflections as well as an atomic model, clicking
            on
            dropdown for reflections we can select our imported reflections, which will leave just the atomic model to
            import.</p>
        <p class="indent"><img src="images/refmac/refmac-task-reflection-selection.png"
                               alt="An image of the CCP4i2 dialogue box for REFMAC5 which is partially filled"></p>
        <p class="indent">Now the folder icon in the red highlighted area can be selected to bring up a file browser
            where
            you can select the <code class="inline-code">carbohydrate-workshop-data.pdb</code> file.
        </p>
        <p class="indent"><img src="images/refmac/refmac-task-finished.png"
                               alt="An image of the CCP4i2 popup box for importing merged reflection data"></p>
        <p class="indent">If it is not already selected, you may need to select the imported FreeR set which is below
            the
            reflection drop down box. After you have an atomic model, reflection set, and FreeR set, you can now press
            the
            <code class="inline-code">Run</code> button to begin running the refinement. Once it is finished, you should
            see a refinement report.
        </p>
        <p class="indent"><img src="images/refmac/refmac-task-report.png"
                               alt="An image of the CCP4i2 REFMAC5 report"></p>
    </details>
    </p>
    <h3 id="modelbuilding">3. Model Building</h3>
    <p>
        Now that we have imported our data and generated some maps, we can start to interactively build the model of a glycan.
        To do this we need to launch <i>Coot</i> from within CCP4i2.
    </p>
    <details>
        <summary class="indent">Hint</summary>
        <p class="indent">Is there something from the<i>REFMAC</i>report that can help us do this? </p>
    </details>

    <p>Once <i>Coot</i> opens, it should look similar to this with an atomic model, best map (2mFo-DFc) and difference map (mFo-DFc) loaded.</p>
    <details>
        <summary class="indent">What does 2mFo-DFc mean?</summary>
        <p class="indent">
            The 2mFo-DFc map is one of the common maps used in crystallography and is not simply a map calculated from
            observed reflection structure factor amplitudes and calculated phases, the addition of weightings from
            the figure of merit (the uncertainty of a given phase) and &sigma;<sub>a</sub> weighting factor often allows
            for a more interpretable map.
            <ul class="indent">
                <li>Fo - Observed Reflections</li>
                <li>Fc - Calculated Reflections</li>
                <li>m - Figure of Merit</li>
                <li>D - &sigma;<sub>a</sub> weight factor</li>
            </ul>
        </p>
    </details>
    <img src="images/coot/coot-initial-look.png" alt="An image of the initial Coot screen"/>
    <p>Look around the model, is there anything that stands out as odd?</p>
    <details>
        <summary class="indent">What's odd?</summary>
        <p class="indent">There is quite a lot of positive difference density for this model, which indicates we may be
        missing part of the model. We're going to try and fix that.
        </p>
    </details>

    <p>This model contains a missing carbohydrate chain, can you spot where it is?</p>
    <details>
        <summary class="indent">How do I find where it is?</summary>
        <p class="indent">
            You can find out where the missing glycan is by looking around the model for an area for a large positive
            difference density, but this may be time-consuming for a big model!
        </p>
        <p class="indent">
            We can ask <i>Coot</i> to look for us using by navigating to
        </p>
        <p class="indent"><code>Validate > Unmodelled blobs...</code></p>
        <p class="indent"><img src="images/coot/coot-validate-blobs.png"
                               alt="An image of Coot highlighting Unmodelled blobs..."></p>
        <p class="indent">Once we click Unmodelled blobs..., a popup will appear asking us to pick a map and model to with.
            In this case, we want to search for blobs in the difference map which show when we contour that map to 4 r.m.s.d.
            Changing from the default of 1.4 r.m.s.d helps us find stronger blobs. You see what this will look for if you
            contour the difference map to 4 sigma. Now click the <code class="inline-code">Find Blobs</code> button to search.
        </p>
        <p class="indent"><img src="images/coot/coot-validate-blobs-popup.png"
                               alt="An image of Coot highlighting Unmodelled blobs..."></p>
        <p class="indent">
            <i>Coot</i> will then return a list of found blobs, and in our case, there is only one large blob it has found, so we can click on that
            to take us to the area where we have an unmodelled glycan. In a real case, you may not know what should go into a
            big blob of difference density, it could be missing protein, a missing ligand or a missing glycan!
        </p>
        <p class="indent"><img src="images/coot/coot-found-blobs.png"
                               alt="An image of Coot highlighting Unmodelled blobs..."></p>
    </details>
    <p>If we center our view on the blob of green density closest to the protein chain, as shown, we are ready to start
    building a model of the missing carbohydrate chain!</p>
    <img src="images/coot/coot-missing-glycan-density.png" alt="An image of the missing glycan density"/>

    <p><i>Coot</i> has a carbohydrate module we will need to load to be able to do this, navigate to and select
        <code class="inline-code">Calculate > Modules > Carbohydrate</code>, which will add the
        <code class="inline-code">Glyco</code> button in the top bar.
    </p>
    <img src="images/coot/coot-carbohydrate-module.png" alt="An image of Coot's carbohydrate module"/>

    <p>Now we can let the semi-automatic glycan builder in <i>Coot</i> handle the heavy lifting. Center your view
        near to the ASN/476 residue of chain A. Then, navigate to and select
        <code class="inline-code">Glyco > N-link add NAG, NAG, BMA </code>. <i>Coot</i> will then attempt to add the
        first three sugars in an N-glycan chain which are NAG followed with another NAG via a 1,4 linkage, followed by a
        BMA sugar via another 1,4 linkage.
    </p>

    <p><i>Coot</i> should have built three sugars nicely into the best (2mFo-DFc) density map as shown. The terminal
    BMA residue looks to have little density to support it at the moment, however, we must remember that the map was
        calculated in the absence of this carbohydrate chain, so before we make judgements on whether <i>Coot</i> has
    added the carbohydrates correctly, we must re-refine the structure using <i>REFMAC</i>. </p>
    <img src="images/coot/coot-nag-nag-bma-built-norefine.png" alt="An image of Coot's built carbohydrate"/>

    <p>Save the mol back to CCP4i2 and exit Coot, now rerun <i>REFMAC</i> with the new model to calculate a new map</p>
    <details open>
        <summary class="indent">How do I do that?</summary>
        <p class="indent">Navigate to the save button,
            <code class="inline-code">File > Save mol to CCP4i2 > Ok</code>
        </p>
        <p class="indent"><img src="images/coot/coot-save-mol.png"
                               alt="An image of the CCP4i2 popup box for importing merged reflection data"></p>
        <p class="indent">Then navigate to the exit button,
            <code class="inline-code">File > Exit</code>.
        </p>
        <p class="indent"><img src="images/coot/coot-exit.png"
                               alt="An image of the CCP4i2 popup box for importing merged reflection data"></p>
        <p class="indent">Now, select another <i>REFMAC</i> task and press the <code class="inline-code">Run</code> button</p>
    </details>

    <p>
        After 10 cycles of <i>REFMAC</i> we can reopen our model and map in <i>Coot</i> (navigating back to A/ASN/476)
        to see that the semi-automatic glycan builder has done a good job, but at this point are we finished?
    </p>

    <p><img src="images/coot/coot-nag-nag-bma-refined.png"></p>

    <details open>
        <summary class="indent">Are we finished?</summary>
        Near to the terminal BMA sugar, we see some suspiciously ring shaped positive difference density. Using the
        <code class="inline-code">Glyco</code> module, see if you can come up with what should go there. Remember that
        <i>Coot</i> looks at the center of the view to know where to put new residues, and once they are positioned, we
        should refine using <i>REFMAC</i>. Try your best at modelling more sugars on this carbohydrate chain, we can check
        how well you have done in Part 2 of this workshop!
        <h6><a href="part2.html">Part 2 - Validating Carbohydrates</a></h6>
    </details>

    <hr>
    <h3 id="references">References</h3>
    <ol class="references">
        <li><a class="reference-link" href="https://doi.org/10.1107/S0907444910007493">Emsley, P., Lohkamp, B., Scott,
            W. G. & Cowtan, K. (2010). Features and development of Coot. Acta Cryst. D66, 486-501.</a></li>
        <li><a class="reference-link" href="10.1107/S2059798317016035">Potterton L, Agirre J, Ballard C, et al. CCP4i2:
            the new graphical user interface to the CCP4 program suite. Acta Cryst. D74, 68-84.</a></li>
        <li><a class="reference-link" href="https://doi.org/10.1016/j.bmc.2018.11.022.">Barinka C, Novakova Z, Hin N, et
            al. Structural and computational basis for potent inhibition of glutamate carboxypeptidase II by
            carbamate-based inhibitors. Bioorg. Med. Chem, Volume 27, Issue 2, 255-264 </a></li>
        <li><a class="reference-link">Murshudov, G. N., Skubak, P., et al. REFMAC5 for the refinement of macromolecular
            crystal structures. Acta Cryst. D67, 355-367.</a></li>

    </ol>
    <hr>
    <p class="acknowledgements">Special thanks to Paul Bond for testing this workshop and for the inspiration. Checkout
    Paul's <i>Coot</i> workshop <a href="https://paulsbond.co.uk/coot-workshop/" target="_blank">here</a> if you want to learn more about <i>Coot</i>.</p>
    <hr>
    <div class="footer">
        <a class="icon" href="mailto:jordan.dialpuri@york.ac.uk"><img src="icons/email.svg"
                                                                      alt="Email icon indicating a link to email an organiser"></a>
        <p>Jordan Dialpuri and Lucy Schofield, University of York</p>
    </div>
</div>
</body>
